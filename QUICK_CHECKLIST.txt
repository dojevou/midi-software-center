# âš¡ QUICK REFERENCE CHECKLIST - Test Fixes Implementation

**Print this page** and check off each step as you complete it.

---

## ğŸ“‹ PRE-FLIGHT CHECKLIST

- [ ] Read README_START_HERE.md (5 min)
- [ ] Have Rust/Cargo installed? `cargo --version` âœ“
- [ ] Have access to project? `ls -la ~/projects/midi-software-center/` âœ“
- [ ] Created backup? `git commit -m "backup"` âœ“
- [ ] Identified implementation option (Automated/Manual)

**Time Estimate**: 10-15 minutes
**Estimated Total Time**: 2-2.5 hours

---

## ğŸ”§ PHASE 1: BRACE ERRORS (5-10 min) âœ… SKIP IF DONE

```bash
# Verify if already fixed
tail -1 pipeline/src-tauri/tests/file_repository_test.rs
# Should NOT be just "}"
```

- [ ] file_repository_test.rs brace fixed
- [ ] metadata_repository_test.rs brace fixed
- [ ] tag_repository_test.rs brace fixed
- [ ] Verify: `cargo build --tests 2>&1 | grep "unexpected" | wc -l` â†’ 0

---

## ğŸ“ PHASE 2: FIELD NAME CHANGES (15-20 min)

**Copy-paste this into terminal:**

```bash
#!/bin/bash
cd /home/dojevou/projects/midi-software-center
find pipeline/src-tauri/tests _disabled_tests -name "*test*.rs" -exec sed -i 's/\.file_id/.id/g' {} \;
find pipeline/src-tauri/tests _disabled_tests -name "*test*.rs" -exec sed -i 's/\.file_path/.filepath/g' {} \;
echo "âœ“ Done!"
```

- [ ] Script executed successfully
- [ ] Verify: `grep -r "\.file_id" pipeline/src-tauri/tests | wc -l` â†’ 0
- [ ] Verify: `grep -r "\.file_path" pipeline/src-tauri/tests | wc -l` â†’ 0
- [ ] Verify: `grep -r "\.id" pipeline/src-tauri/tests | wc -l` â†’ many (100+)

---

## ğŸ¯ PHASE 3: TRAIT GENERICS (10-15 min)

**Copy-paste this into terminal:**

```bash
cd /home/dojevou/projects/midi-software-center
find pipeline/src-tauri/tests _disabled_tests -name "*.rs" -exec sed -i 's/impl Emitter for/impl<R: tauri::Runtime> Emitter<R> for/g' {} \;
echo "âœ“ Done!"
```

- [ ] Script executed successfully
- [ ] Verify: `grep "impl.*Emitter" pipeline/src-tauri/tests/*.rs | head -1` shows <R: ...>

---

## ğŸ› ï¸ PHASE 4: TEST HELPERS (15-20 min)

**Create file: `pipeline/src-tauri/tests/test_helpers.rs`**

Use content from STEP_BY_STEP_IMPLEMENTATION_GUIDE.md Phase 4, or copy-paste from:
[See document for full content]

- [ ] File created: `pipeline/src-tauri/tests/test_helpers.rs`
- [ ] Updated mod.rs with: `pub mod test_helpers;`
- [ ] Verify file exists: `ls -la pipeline/src-tauri/tests/test_helpers.rs`

---

## âš™ï¸ PHASE 5: TAURI STATE FIXES (45-60 min) âš ï¸ COMPLEX

**This phase needs review. Two options:**

### Option A: Run Semi-Automated
```bash
cd /home/dojevou/projects/midi-software-center
bash apply_test_fixes.sh --dry-run  # See what would change
# Review output
cargo build --tests 2>&1 | head -20  # Check errors
```

### Option B: Manual Review
For each error pattern found, consult ERROR_TO_FIX_MAPPING.md section 2.

Key changes:
- [ ] Replace `tauri::State(&state)` with `&state` (where safe)
- [ ] Create wrapper functions in commands (if needed)
- [ ] Update function calls to use direct AppState reference

**Complexity Note**: This phase may require customization per function.
**Recommendation**: Run `cargo build --tests` after each fix to verify.

---

## âœ… PHASE 6: VERIFICATION & TESTING (10-15 min)

**Run these commands in sequence:**

```bash
cd /home/dojevou/projects/midi-software-center

# Step 1: Clean build
cargo clean
echo "Building..."
cargo build --tests 2>&1 | tee build.log

# Check error count
echo "Error summary:"
grep "^error\[" build.log | cut -d: -f1 | sort | uniq -c

# Step 2: If 0 errors, run tests
echo "Running tests..."
cargo test --lib --tests 2>&1 | tee test-results.log

# Step 3: Check results
tail -20 test-results.log
```

- [ ] `cargo build --tests` completes
- [ ] Number of errors: _______ (Should be 0)
- [ ] `cargo test --lib` passes (or shows expected failures only)
- [ ] No new warnings introduced

---

## ğŸ‰ COMPLETION & DEPLOYMENT

- [ ] All compilation errors fixed (0 remaining)
- [ ] All phases completed successfully
- [ ] Backups verified and safe
- [ ] Ready to commit

**Final Steps:**

```bash
cd /home/dojevou/projects/midi-software-center

# Commit fixes
git add -A
git commit -m "Fix all test compilation errors - Phase 9 Extended"

# Verify commit
git log --oneline | head -1

# Optional: Create tag
git tag -a v1.0-tests-fixed -m "All tests compilation fixed"
```

- [ ] Changes committed to git
- [ ] Remote pushed (if applicable)
- [ ] Tag created (optional)

---

## ğŸ†˜ TROUBLESHOOTING QUICK GUIDE

### Error: "no field `file_id`"
â†’ Phase 2 script didn't run or didn't work  
â†’ **Fix**: Re-run `fix_field_names.sh` or manually check sed syntax

### Error: "missing generics for trait `Emitter`"
â†’ Phase 3 script didn't run  
â†’ **Fix**: Re-run `fix_emitter_trait.sh` or check command syntax

### Error: "cannot initialize tuple struct (private fields)"
â†’ Phase 5 incomplete  
â†’ **Fix**: Replace `tauri::State(&state)` with `&state` (see ERROR_TO_FIX_MAPPING.md)

### Compilation hangs
â†’ Out of memory or infinite loop  
â†’ **Fix**: `pkill -f cargo` then `cargo build --tests -j 1` (use 1 thread)

### Tests still fail after compilation
â†’ This is OK - logic may need fixing  
â†’ **Next Step**: Run with `--nocapture` to see error details

### Want to undo all changes?
â†’ **Run**: 
```bash
# Git rollback
git checkout HEAD -- pipeline/src-tauri/tests/

# OR directory rollback
cp -r pipeline/src-tauri/tests.backup/* pipeline/src-tauri/tests/
```

---

## ğŸ“Š PROGRESS TRACKER

### Time Estimate vs Actual

| Phase | Est. Time | Actual | âœ“ |
|-------|-----------|--------|---|
| Pre-flight | 15 min | | |
| Phase 1 | 10 min | | |
| Phase 2 | 20 min | | |
| Phase 3 | 15 min | | |
| Phase 4 | 20 min | | |
| Phase 5 | 60 min | | |
| Phase 6 | 15 min | | |
| **TOTAL** | **155 min** | | |

**Started**: _________  
**Completed**: _________  
**Total Time**: _________  

---

## ğŸ“ RESOURCES

### Documentation Files
- `README_START_HERE.md` â† Overview (this directory)
- `TEST_FIX_STRATEGY_COMPLETE.md` â† Full strategy
- `ERROR_TO_FIX_MAPPING.md` â† Detailed error reference
- `STEP_BY_STEP_IMPLEMENTATION_GUIDE.md` â† Execution guide
- `apply_test_fixes.sh` â† Automated script

### Project Files
- Tests: `/home/dojevou/projects/midi-software-center/pipeline/src-tauri/tests/`
- Commands: `/home/dojevou/projects/midi-software-center/pipeline/src-tauri/src/commands/`
- Models: `/home/dojevou/projects/midi-software-center/pipeline/src-tauri/src/db/models.rs`

### Key Commands Reference

```bash
# View compilation errors
cargo build --tests 2>&1 | grep "^error"

# Count by type
cargo build --tests 2>&1 | grep "^error\[" | cut -d: -f1 | uniq -c

# Run specific test
cargo test --test journey_test

# Search for patterns
grep -rn "pattern" path/
grep -c "pattern" file.rs

# Replace in files (sed)
sed -i 's/old/new/g' file.rs
sed -i 's/old/new/g' $(find path -name "*.rs")
```

---

## âœ¨ FINAL NOTES

### Why This Works
- âœ… All errors are compilation (not runtime)
- âœ… All fixes are mechanical (field renames, etc.)
- âœ… No logic changes needed
- âœ… Backups protect against mistakes
- âœ… Each phase builds on previous

### Confidence Level
ğŸŸ¢ **95%+ success** on first attempt

### If Issues Occur
1. Check ERROR_TO_FIX_MAPPING.md for that specific error
2. Review the troubleshooting section above
3. Consult STEP_BY_STEP_IMPLEMENTATION_GUIDE.md
4. Use git/backups to rollback if needed

---

## ğŸš€ READY?

**YOU HAVE EVERYTHING YOU NEED TO FIX ALL TESTS IN 2-2.5 HOURS**

**Start with:**
1. This checklist (you're reading it!)
2. README_START_HERE.md (next)
3. STEP_BY_STEP_IMPLEMENTATION_GUIDE.md (then this)
4. Execute phases 1-6 in order

**Questions?** See ERROR_TO_FIX_MAPPING.md

---

**Created**: November 4, 2025  
**Status**: Ready for Use âœ…  
**Good Luck!** ğŸ‰  

